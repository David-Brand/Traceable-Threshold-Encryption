cmake_minimum_required(VERSION 3.20)

project(btbf_project LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
add_compile_options(/openmp)

if (MSVC)
    # /MT in ALL configs (Debug/Release)
    set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded")
endif()

set(MCL_ROOT "c:/Programme/mcl" CACHE PATH "Path to mcl root directory")

set(MCL_INCLUDE_DIR "${MCL_ROOT}/include")
set(MCL_LIB "${MCL_ROOT}/lib/mcl.lib")

add_executable(btbf
    src/main.cpp
    src/btbf.cpp
    src/TTT.cpp
    src/fingerprinting_codes.cpp
)

target_include_directories(btbf PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}/src
    ${MCL_INCLUDE_DIR}
)

target_link_libraries(btbf PRIVATE "${MCL_LIB}")

if (MSVC)
    target_compile_options(btbf PRIVATE
        $<$<CONFIG:Release>:/O2 /DNDEBUG>
    )
endif()
